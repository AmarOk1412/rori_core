# This will build but cannot run it... dbus issues
FROM fedora:27
MAINTAINER SÃ©bastien Blin <contact@enconn.fr>

RUN dnf update -y

# Install ring-daemon
RUN dnf install dnf-plugins-core -y
RUN dnf config-manager --add-repo https://dl.ring.cx/ring-nightly/fedora_27/ring-nightly.repo
RUN dnf install ring -y # TODO replace by ring-daemon but doesn't seems to work

# Install Rust
RUN dnf install rust cargo -y

# Install rori_core dependencies
RUN dnf install sqlite dbus-devel ncurses-devel openssl-devel -y
RUN dnf install python python3-devel sqlite-devel -y # for cargo build

# Build RORI
COPY . /root/rori_core
WORKDIR "/root/rori_core"
RUN make build

CMD make run
